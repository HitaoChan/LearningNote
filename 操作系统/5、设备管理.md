# 1、管理概述

## 1.1、I/O设备的分类与I/O管理的任务

### 1.I/O设备的分类

#### 按设备的使用特性分类

- 存储设备：计算机用来保存信息的设备，如磁盘、磁带
- 人机交互设备：输入输出设备
- 网络通信设备：网络接口，调制解调器

#### 按信息交换单位分类

- 字符设备：处理信息的基本单位是字符
- 块设备：处理信息的基本单位是字符块

#### 按传输速率分类

- 低速设备：传输速率每秒几个字节乃至数百个字节的设备
- 中速设备：传输速率每秒几千个字节乃至数万个字节的设备
- 高速设备：传输速率每秒几十万个字节乃至数十兆个字节的设备

#### 按设备的共享属性分类

- 独占设备。属于临界资源
- 共享设备。允许若干个进程交替的读写信息，同一时刻只允许一个进程运行
- 虚拟设备。通过虚拟技术让一个独占设备在逻辑上被多个进程同时使用的设备

### 2.I/O管理的任务和功能

#### 设备分配

按照设备类型和对应分配算法决定将I/O设备分配给哪一个进程

#### 设备管理

设备处理程序用以实现CPU和设备控制器之间的通信

#### 缓存管理

设置缓冲区的目的是为了缓和CPU与I/O设备速度不匹配的矛盾。缓冲管理程序负责完成缓冲区的分配、释放以及有关的管理工作。

#### 设备独立性

又称设备无关性，是指应用程序独立于物理设备。尽量避免使用实际设备名。

## 1.2、I/O控制方式

![img](https://gitee.com/HaitoChan/upload-pic-typora/raw/master/null/1-140F2151126349.jpg)

### 1.程序直接控制方式

早起的操作系统，没有中断系统，所以CPU和I/O设备进行通信、传输数据时，由于CPU的速度快于I/O设备，因此CPU需要不断地测试I/O设备。这种控制方式又叫轮询或忙等。

- 优点：工作过程非常简单
- 缺点：CPU的利用率相当低

### 2.中断控制方式

- 优点：有了中断的硬件支持后，CPU和I/O设备间可以并行工作了，大大提高了CPU利用率
- 缺点：每台设备每输入/输出一个数据，都要求中断CPU，这样在一次数据传送过程中的中断次数过多，从而耗费了大量CPU时间。

### 3.DMA控制方式

基本思想：是在外设和内存之间开辟直接的数据交换通路

范围：块设备的数据传输

在DMA控制方式中，设备控制器具有更强的功能，在其控制下，设备和内存之间可以成批地进行数据交换，而不是用CPU干预。

优点：大大减轻了CPU的负担，也使I/O数据传输速率大大提高。

DMA控制方式特点：数据传输的基本单位是数据块；数据是单向传输，且从设备直接送入内存或者相反；仅在传送一个或多个数据块的开始和结束时，才需CPU干预，整块数据的传送是在控制器的控制下完成的。

**DMA控制方式与中断控制方式的主要区别是**：

中断控制方式在每个数据传送完成后中断CPU，而DMA控制方式的数据传送则是在所要求的一批数据全部传送结束时才中断CPU；中断控制方式的数据传送是由CPU控制完成，而DMA控制方式是由DMA控制器的控制下完成。

<center>DMA控制器的组成</center>

![](https://gitee.com/HaitoChan/upload-pic-typora/raw/master/null/1-140F215152VA.jpg)

DMA控制器中设置如下四类寄存器：

1. 命令/状态寄存器(CR)：用于接收从CPU发来的I/O命令或有关控制信息，或设备的状态。
2. 内存地址寄存器(MAR)：在输入时，它存放把数据从设备传送到内存的起始目标地址；在输出时，它存放由内存到设备的内存源地址。
3. 数据寄存器(DR)：用于暂存从设备到内存，或从内存到设备的数据。
4. 数据计数器(DC)：存放本次CPU要读或写的字（节）数。

- 优点：设备和CPU可以并行工作，同时设备与内存的数据交换速度加快，并且不需要CPU干预
- 缺点：数据传送的方向、存放输入数据的内存起始地址及传送数据的长度等都由CPU控制；并且每台设备都需要一个DMA控制器，当设备增加时，不经济。

### 4.通道控制方式

与DMA控制方式相似，以内存为中心，实现设备与内u你直接交换数据的控制方式。

一个通道控制可以做到控制多台设备，进一步减轻了CPU负担。

通道指令类型单一，由于通道硬件比较简单，其所能执行的命令主要局限于与I/O操作有关的指令；通道没有自己的内存，通道执行的通道程序是放在主机的内存中的，换言之，是通道与CPU共享内存。

#### 字节多路通道

单位：字节

用于连接慢速的和中速的设备

通道可以以字节交叉方式轮流为多个外设服务

#### 数组选择通道

用于连接高速设备，但只有一个分配型子通道

通道的利用率低

#### 数组多路通道

有很高的传输速率，但每次只允许一个设备传输数据

- 优点：
- 缺点

## 1.3、I/O软件层次结构

### 1.层次结构概述

### 2.中断处理程序

### 3.设备驱动程序

### 4.设备独立性软件

### 5.用户层软件

# 2、I/O核心子系统

## 2.1、I/O调度概念

## 2.2、高速缓存与缓冲区

### 1.缓冲的引入

### 2.缓冲的分类

#### 单缓冲

#### 双缓冲

#### 循环缓冲

#### 缓冲池

### 3.告诉缓存与缓冲区

## 2.3、设备分配与回收

### 1.设备管理中的数据结构

### 2.设备分配策略

#### 设备的使用性质

#### 设备分配算法

#### 设备分配的安全性

### 3.设备独立性

### 4.设备分配程序

#### 单通路I/O系统的设备分配

#### 多通路I/O系统的设备分配

### 5.设备的回收

## 2.4、假脱机技术

### 1.SPOOLING系统的组成

#### 输入井和输出井

#### 输入缓冲区和输出缓冲区

#### 输出进程和输出进程

### 2.SPLOOING技术的特点



